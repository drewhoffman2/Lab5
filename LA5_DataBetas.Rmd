---
title: "Lab 5"
author: "Drew Hoffman, Tanner Ball, Burke Parent, David Washburn, Brandon Nelsen"
date: "9/27/2019"
output: html_document
---

```{r}
# Load tidyverse
library(tidyverse)

# Load and view the data
milk <- read.csv('state_milk_production.csv')
head(milk)

# Add a column for millions of milk pounds
milk <- milk %>%
  mutate(milk_million = milk_produced/1000000)
```

**Team Section:**

**Arizona, California, Colorado, Illinois, and Texas**

```{r, echo=FALSE}
milksub <- milk %>%
  filter(state %in% c('Arizona','California','Colorado','Illinois','Texas')) %>%
  select(state, year, milk_million)

milkavg <- milk %>% select(year, milk_million) %>% group_by(year) %>% summarise(avg = sum(milk_million)/50)

ggplot() +
  geom_point(data = milksub, aes(x = year, y = milk_million, color = state)) + 
  ggtitle('Pounds of milk over time by state') +
  xlab('Year') +
  ylab('Milk Produced (Million lb)') +
  geom_smooth(data=milkavg, aes(x=year, y=avg), color='black')
```

**Information That the Plot Conveys:**

```{r, echo = FALSE}
ggplot(data = milk, aes(x = as.factor(year), y = (milk_million), fill = as.factor(year), width = .25)) +
  geom_col()+coord_flip() + ylab('Milk, Millions of Pounds') + xlab('Year') + labs(fill = 'Year by Color')
```


Year of most milk production: The year in which the most milk was produced was 2017, as shown by the bar shart below. The chart shows the total milk produced in millions of pounds for each year.

Year of least milk production: The year in which the least amount of milk was produced is 1975, as shown by the graph.

2017 5 states with most milk: From the table below, the states that produced the most milk in 2017 were: California, Wisconsin, New York, Idaho, and Texas.
```{r}
filter(milk, year == 2017) %>%
  arrange(desc(milk_produced)) %>%
  group_by(milk_produced)
```


2017 5 states with least milk: From the table below, the states that produced the least amount of milk in 2017 were: Alaska, Rhode Island, Hawaii, Aransas, and Alabama.
```{r}
filter(milk, year == 2017) %>%
  arrange((milk_produced)) %>%
  group_by(milk_produced)
```

**Individual Sections**

**Drew:**

```{r, echo=FALSE}

```

**Brandon:**

```{r, echo=FALSE}

```

**David:**

The plot below shows the distribution of milk production in 1999.
```{r}
ninetyNine <-
  filter(milk, year == 1999)

ggplot(data = ninetyNine, aes(x = milk_million)) +
  geom_density() +
  ggtitle('Distribution of Milk in 1999') +
  xlab('Milk in Millions of Pounds') +
  ylab('Density')
```
The median milk production for each state is shown in the table below.
```{r}
medianNinetyNine <- ninetyNine %>%
  group_by(state) %>%
  summarise(Median_Production = median(milk_million)) %>%
  as_tibble()

medianNinetyNine
```
The mean milk production for each state is shown in the table below.
```{r}
meanNinetyNine <- ninetyNine %>%
  group_by(state) %>%
  summarise(Mean_Production = mean(milk_million)) %>%
  as_tibble()

meanNinetyNine
```
The table below shows the states that produced the most milk. Caifornia was the most with 30444 million pounds.
```{r}
mostNinetyNine <- ninetyNine %>%
  arrange(desc(milk_produced)) %>%
  group_by(milk_produced)

mostNinetyNine
```
The table below shows the states that produced the least milk. Alaska was the least with 14 million pounds.
```{r}
leastNinetyNine <- ninetyNine %>%
  arrange(milk_produced) %>%
  group_by(milk_produced)

leastNinetyNine
```


**Tanner:**

```{r, echo=FALSE}
```

**Burke:**

```{r, echo=FALSE}
library(tidyverse)

milk <- read.csv('state_milk_production.csv')

milk <- milk %>%
  mutate(milk_million = milk_produced/1000000)

milk1999 <- milk %>%
  filter(year == 1999)
head(milk1999)

ggplot(data = milk1999, aes(x = milk_million)) +
  geom_density() + 
  ggtitle('Estimated Distribution of Milk Production, 1999')+
  xlab('Pounds of Milk, Millions')+
  ylab('Density')

summarize(milk1999,overall_mean = mean(milk_million, na.rm = TRUE), overall_median = median(milk_million, na.rm = TRUE))
```

**Most helpful thing:**


**Ethical Analysis**

