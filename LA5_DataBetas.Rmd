---
title: "Lab 5"
author: "Drew Hoffman, Tanner Ball, Burke Parent, David Washburn, Brandon Nelsen"
date: "9/27/2019"
output: html_document
---

```{r inlcude = FALSE}
# Load tidyverse
library(tidyverse)

# Load and view the data
milk <- read.csv('state_milk_production.csv')
head(milk)

# Add a column for millions of milk pounds
milk <- milk %>%
  mutate(milk_million = milk_produced/1000000)
```

**Team Section:**

**Arizona, California, Colorado, Illinois, and Texas**

```{r, echo=FALSE}
milksub <- milk %>%
  filter(state %in% c('Arizona','California','Colorado','Illinois','Texas')) %>%
  select(state, year, milk_million)

milkavg <- milk %>% select(year, milk_million) %>% group_by(year) %>% summarise(avg = sum(milk_million)/50)

ggplot() +
  geom_point(data = milksub, aes(x = year, y = milk_million, color = state)) + 
  ggtitle('Pounds of milk produced over time by state') +
  xlab('Year') +
  ylab('Milk Produced (Million lb)') +
  geom_smooth(data=milkavg, aes(x=year, y=avg), color='black')
```

**Information That the Plot Conveys:**

```{r, echo = FALSE}
ggplot(data = milk, aes(x = as.factor(year), y = (milk_million), fill = as.factor(year), width = .25)) +
  geom_col()+coord_flip() + ylab('Milk, Millions of Pounds') + xlab('Year') + labs(fill = 'Year by Color')
```


Year of most milk production: The year in which the most milk was produced was 2017, as shown by the bar shart below. The chart shows the total milk produced in millions of pounds for each year.

Year of least milk production: The year in which the least amount of milk was produced is 1975, as shown by the graph.

2017 5 states with most milk: From the table below, the states that produced the most milk in 2017 were: California, Wisconsin, New York, Idaho, and Texas.
```{r}
filter(milk, year == 2017) %>%
  arrange(desc(milk_produced)) %>%
  top_n(5) %>%
  group_by(milk_produced)
```


2017 5 states with least milk: From the table below, the states that produced the least amount of milk in 2017 were: Alaska, Rhode Island, Hawaii, Aransas, and Alabama.
```{r}
filter(milk, year == 2017) %>%
  arrange((milk_produced)) %>%
  top_n(-5) %>%
  group_by(milk_produced)
```

**Individual Sections**

**Drew:**

```{r, echo=FALSE}
milk2000 <- milk %>%
  filter(year == 2000)
head(milk2000)

ggplot(data = milk2000, aes(x = as.factor(year), y = milk_million, fill = as.factor(year))) +
  geom_boxplot() +
  ggtitle('Pounds of milk produced at the state-level in 2000') + 
  scale_fill_discrete(name = 'Year') + 
  xlab('Year') +
  ylab('Milk Produced (Millions lb)')

summarise(milk2000, overall_mean = mean(milk_million, na.rm = TRUE), overall_median = median(milk_million, na.rm = TRUE))

```

Average Milk Produced in 2000: 3347.84 million pounds

Median Milk Produced in 2000: 1453.5 million pounds

Most Milk in 2000: California

Least Milk in 2000: Alaska

**Brandon:**

```{r, echo=FALSE}
milk2000 <- milk %>%
  filter(year == 2000)

ggplot(data = milk2000, mapping = (aes(x = milk_million))) +
  geom_density()+
  ggtitle('Esitimated Distribution of milk (per million pounds) in the year 2000')+
  xlab('Milk produced (millon lb)')
most_produced <- milk2000 %>%
  top_n(1)
least_produced <- milk2000 %>%
  top_n(-1)
'State with most milk production in the year 2000: California'
most_produced
'State with least milk production in the year 2000: Alaska'
least_produced
milk2000 %>%
  arrange(milk_million) %>%
  summarise(mean = mean(milk_million, na.rm = TRUE), median = median(milk_million, na.rm = TRUE))
```

**David:**

```{r, echo=FALSE}

```

**Tanner:**

```{r, echo=FALSE}
milk1998 <- milk %>% filter(year == 1998)
head(milk1998)
ggplot(data = milk1998, aes(x = milk_million)) +
  geom_density() +
  ggtitle('Estimated Distribution of Milk Production, 1998') +
  xlab('Pounds of Milk, Millions') +
  ylab('Density')

summarise(milk1998, overall_mean = mean(milk_million, na.rm = TRUE), overall_median = median(milk_million, na.rm = TRUE))
```

**Burke:**

```{r, echo=FALSE}
library(tidyverse)

milk <- read.csv('state_milk_production.csv')

milk <- milk %>%
  mutate(milk_million = milk_produced/1000000)

milk1999 <- milk %>%
  filter(year == 1999)
head(milk1999)

ggplot(data = milk1999, aes(x = milk_million)) +
  geom_density() + 
  ggtitle('Estimated Distribution of Milk Production, 1999')+
  xlab('Pounds of Milk, Millions')+
  ylab('Density')

summarize(milk1999,overall_mean = mean(milk_million, na.rm = TRUE), overall_median = median(milk_million, na.rm = TRUE))
```

**Most helpful thing:**


**Ethical Analysis**

